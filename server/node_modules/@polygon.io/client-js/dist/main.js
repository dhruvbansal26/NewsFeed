import Be from"cross-fetch";var O={fetch:(t,s)=>Be(t,s)};import{stringify as Xe}from"query-string";var k=class extends Error{constructor(o,e="",r=""){super(o);this.status=e,this.request_id=r}},i=(t,s,o={})=>async(e,r={},n={})=>{if(!t)throw new Error("API KEY not configured...");let u=Xe(r,{encode:!0}),p=`${s}${e}?${u}`;try{let c=await O.fetch(p,{...o,...n,headers:{...n.headers||o.headers||{},Authorization:`Bearer ${t}`}});if(c.status>=400){let _=await c.text(),h;try{let I=JSON.parse(_);h=new k(I.message,I.status,I.request_id)}catch{h=new Error(_)}throw h}return c?.headers?.get("content-type")==="text/csv"?c.text():c.json()}catch(c){throw c}};var v=async(t,s,o,e,r,n,u,p)=>t(`/v2/aggs/ticker/${s}/range/${o}/${e}/${r}/${n}`,u,p);var R=async(t,s,o,e)=>t(`/v2/aggs/grouped/locale/global/market/crypto/${s}`,o,e);var T=async(t,s,o,e,r,n)=>t(`/v1/open-close/crypto/${s}/${o}/${e}`,r,n);var C=async(t,s,o,e)=>t(`/v3/trades/${s}`,o,e);var P=async(t,s,o,e,r)=>t(`/v1/last/crypto/${s}/${o}`,e,r);var S=async(t,s,o,e)=>t(`/v2/aggs/ticker/${s}/prev`,o,e);var G=(t,s,o)=>t("/v2/snapshot/locale/global/markets/crypto/tickers",s,o),A=(t,s,o,e)=>t(`/v2/snapshot/locale/global/markets/crypto/${s}`,o,e),D=(t,s,o,e)=>t(`/v2/snapshot/locale/global/markets/crypto/tickers/${s}`,o,e),w=(t,s,o,e)=>t(`/v2/snapshot/locale/global/markets/crypto/tickers/${s}/book`,o,e);var $=async(t,s,o)=>t("/v1/summaries",s,o);var g=async(t,s,o,e)=>t(`/v1/indicators/sma/${s}`,o,e);var L=async(t,s,o,e)=>t(`/v1/indicators/sma/${s}`,o,e);var l=async(t,s,o,e)=>t(`/v1/indicators/ema/${s}`,o,e);var F=async(t,s,o,e)=>t(`/v1/indicators/ema/${s}`,o,e);var y=async(t,s,o,e)=>t(`/v1/indicators/macd/${s}`,o,e);var E=async(t,s,o,e)=>t(`/v1/indicators/macd/${s}`,o,e);var d=async(t,s,o,e)=>t(`/v1/indicators/rsi/${s}`,o,e);var U=async(t,s,o,e)=>t(`/v1/indicators/rsi/${s}`,o,e);var m=async(t,s,o)=>t("/v3/snapshot",s,o);var M=async(t,s,o)=>t("/v1/summaries",s,o);var W=(t,s="https://api.polygon.io",o)=>{let e=i(t,s,o);return{aggregates:(...r)=>v(e,...r),aggregatesGroupedDaily:(...r)=>R(e,...r),summaries:(...r)=>$(e,...r),dailyOpenClose:(...r)=>T(e,...r),lastTrade:(...r)=>P(e,...r),trades:(...r)=>C(e,...r),previousClose:(...r)=>S(e,...r),snapshotAllTickers:(...r)=>G(e,...r),snapshotGainersLosers:(...r)=>A(e,...r),snapshotTicker:(...r)=>D(e,...r),snapshotTickerFullBookL2:(...r)=>w(e,...r),sma:(...r)=>L(e,...r),ema:(...r)=>F(e,...r),macd:(...r)=>E(e,...r),rsi:(...r)=>U(e,...r),universalSnapshot:(...r)=>m(e,...r)}};var N=async(t,s,o,e,r,n,u,p)=>t(`/v2/aggs/ticker/${s}/range/${o}/${e}/${r}/${n}`,u,p);var z=async(t,s,o,e)=>t(`/v2/aggs/grouped/locale/global/market/fx/${s}`,o,e);var H=async(t,s,o,e,r)=>t(`/v1/conversion/${s}/${o}`,e,r);var j=async(t,s,o,e)=>t(`/v3/quotes/${s}`,o,e);var V=(t,s,o,e,r)=>t(`/v1/last_quote/currencies/${s}/${o}`,e,r);var B=async(t,s,o,e)=>t(`/v2/aggs/ticker/${s}/prev`,o,e);var X=async(t,s,o)=>t("/v2/snapshot/locale/global/markets/forex/tickers",s,o),J=async(t,s,o,e)=>t(`/v2/snapshot/locale/global/markets/forex/${s}`,o,e),Y=async(t,s,o,e)=>t(`/v2/snapshot/locale/global/markets/forex/tickers/${s}`,o,e);var Z=async(t,s,o)=>t("/v1/summaries",s,o);var K=async(t,s,o,e)=>t(`/v1/indicators/sma/${s}`,o,e);var ee=async(t,s,o,e)=>t(`/v1/indicators/ema/${s}`,o,e);var te=async(t,s,o,e)=>t(`/v1/indicators/macd/${s}`,o,e);var re=async(t,s,o,e)=>t(`/v1/indicators/rsi/${s}`,o,e);var se=(t,s="https://api.polygon.io",o)=>{let e=i(t,s,o);return{aggregates:(...r)=>N(e,...r),aggregatesGroupedDaily:(...r)=>z(e,...r),summaries:(...r)=>Z(e,...r),conversion:(...r)=>H(e,...r),quotes:(...r)=>j(e,...r),lastQuote:(...r)=>V(e,...r),previousClose:(...r)=>B(e,...r),snapshotAllTickers:(...r)=>X(e,...r),snapshotGainersLosers:(...r)=>J(e,...r),snapshotTicker:(...r)=>Y(e,...r),sma:(...r)=>K(e,...r),ema:(...r)=>ee(e,...r),macd:(...r)=>te(e,...r),rsi:(...r)=>re(e,...r),universalSnapshot:(...r)=>m(e,...r)}};var oe=async(t,s,o)=>t("/v3/reference/conditions",s,o);var ne=async(t,s,o)=>t("/v3/reference/exchanges",s,o);var ie=async(t,s,o)=>t("/v1/marketstatus/upcoming",s,o);var ae=async(t,s,o)=>t("/v1/marketstatus/now",s,o);var ue=(t,s,o,e)=>t(`/v3/reference/options/contracts/${s}`,o,e);var pe=(t,s,o)=>t("/v3/reference/options/contracts",s,o);var me=async(t,s,o)=>t("/v3/reference/dividends",s,o);var ce=async(t,s,o)=>t("/v3/reference/splits",s,o);var Ie=async(t,s,o)=>t("/vX/reference/financials",s,o);var ge=async(t,s,o,e)=>t(`/v3/reference/tickers/${s}`,o,e);var le=async(t,s,o)=>t("/v2/reference/news",s,o);var ye=async(t,s,o)=>t("/v3/reference/tickers",s,o);var de=async(t,s,o)=>t("/v3/reference/tickers/types",s,o);var fe=(t,s="https://api.polygon.io",o)=>{let e=i(t,s,o);return{conditions:(...r)=>oe(e,...r),exchanges:(...r)=>ne(e,...r),marketHolidays:(...r)=>ie(e,...r),marketStatus:(...r)=>ae(e,...r),optionsContract:(...r)=>ue(e,...r),optionsContracts:(...r)=>pe(e,...r),dividends:(...r)=>me(e,...r),stockSplits:(...r)=>ce(e,...r),stockFinancials:(...r)=>Ie(e,...r),tickerDetails:(...r)=>ge(e,...r),tickerNews:(...r)=>le(e,...r),tickers:(...r)=>ye(e,...r),tickerTypes:(...r)=>de(e,...r)}};var be=async(t,s,o,e,r,n,u,p)=>t(`/v2/aggs/ticker/${s}/range/${o}/${e}/${r}/${n}`,u,p);var xe=async(t,s,o,e,r)=>t(`/v1/open-close/${s}/${o}`,e,r);var he=async(t,s,o,e)=>t(`/v2/aggs/ticker/${s}/prev`,o,e);var ke=async(t,s,o,e)=>t(`/v3/trades/${s}`,o,e);var Qe=async(t,s,o,e)=>t(`/v2/last/trade/${s}`,o,e);var qe=async(t,s,o,e)=>t(`/v3/quotes/${s}`,o,e);var Q=async(t,s,o,e)=>t(`/v3/snapshot/options/${s}`,o,e),q=async(t,s,o,e,r)=>t(`/v3/snapshot/options/${s}/${o}`,e,r);var _e=async(t,s,o)=>t("/v1/summaries",s,o);var Oe=async(t,s,o,e)=>t(`/v1/indicators/sma/${s}`,o,e);var ve=async(t,s,o,e)=>t(`/v1/indicators/ema/${s}`,o,e);var Re=async(t,s,o,e)=>t(`/v1/indicators/macd/${s}`,o,e);var Te=async(t,s,o,e)=>t(`/v1/indicators/rsi/${s}`,o,e);var Ce=(t,s="https://api.polygon.io",o)=>{let e=i(t,s,o);return{aggregates:(...r)=>be(e,...r),summaries:(...r)=>_e(e,...r),dailyOpenClose:(...r)=>xe(e,...r),previousClose:(...r)=>he(e,...r),trades:(...r)=>ke(e,...r),lastTrade:(...r)=>Qe(e,...r),quotes:(...r)=>qe(e,...r),snapshotOptionContract:(...r)=>q(e,...r),snapshotOptionChain:(...r)=>Q(e,...r),sma:(...r)=>Oe(e,...r),ema:(...r)=>ve(e,...r),macd:(...r)=>Re(e,...r),rsi:(...r)=>Te(e,...r),universalSnapshot:(...r)=>m(e,...r)}};var f=async(t,s,o,e,r,n,u,p)=>t(`/v2/aggs/ticker/${s}/range/${o}/${e}/${r}/${n}`,u,p);var Pe=async(t,s,o,e)=>t(`/v2/aggs/grouped/locale/us/market/stocks/${s}`,o,e);var b=async(t,s,o,e,r)=>t(`/v1/open-close/${s}/${o}`,e,r);var x=async(t,s,o,e)=>t(`/v2/aggs/ticker/${s}/prev`,o,e);var Se=async(t,s,o,e)=>t(`/v2/last/nbbo/${s}`,o,e);var Ge=async(t,s,o,e)=>t(`/v2/last/trade/${s}`,o,e);var Ae=async(t,s,o)=>t("/v2/snapshot/locale/us/markets/stocks/tickers",s,o),De=async(t,s,o,e)=>t(`/v2/snapshot/locale/us/markets/stocks/${s}`,o,e),we=async(t,s,o,e)=>t(`/v2/snapshot/locale/us/markets/stocks/tickers/${s}`,o,e);var $e=async(t,s,o,e)=>t(`/v3/quotes/${s}`,o,e);var Le=async(t,s,o,e)=>t(`/v3/trades/${s}`,o,e);var Fe=(t,s="https://api.polygon.io",o)=>{let e=i(t,s,o);return{aggregates:(...r)=>f(e,...r),aggregatesGroupedDaily:(...r)=>Pe(e,...r),summaries:(...r)=>M(e,...r),dailyOpenClose:(...r)=>b(e,...r),lastQuote:(...r)=>Se(e,...r),lastTrade:(...r)=>Ge(e,...r),previousClose:(...r)=>x(e,...r),quotes:(...r)=>$e(e,...r),snapshotAllTickers:(...r)=>Ae(e,...r),snapshotGainersLosers:(...r)=>De(e,...r),snapshotTicker:(...r)=>we(e,...r),sma:(...r)=>g(e,...r),ema:(...r)=>l(e,...r),macd:(...r)=>y(e,...r),rsi:(...r)=>d(e,...r),trades:(...r)=>Le(e,...r),universalSnapshot:(...r)=>m(e,...r)}};var Ee=async(t,s,o)=>t("/v3/snapshot/indices/",s,o);var Ue=(t,s="https://api.polygon.io",o)=>{let e=i(t,s,o);return{aggregates:(...r)=>f(e,...r),dailyOpenClose:(...r)=>b(e,...r),previousClose:(...r)=>x(e,...r),snapshotTicker:(...r)=>Ee(e,...r),sma:(...r)=>g(e,...r),ema:(...r)=>l(e,...r),macd:(...r)=>y(e,...r),rsi:(...r)=>d(e,...r)}};var Je=(t,s,o)=>({crypto:W(t,s,o),forex:se(t,s,o),reference:fe(t,s,o),options:Ce(t,s,o),stocks:Fe(t,s,o),indices:Ue(t,s,o)}),Me=Je;import Ye from"websocket";var a=(t,s)=>{if(!s)throw new Error("api key not provided.");let o=new Ye.w3cwebsocket(t);return o.onopen=()=>{o.send(JSON.stringify({action:"auth",params:s}))},o};var We=(t,s="wss://socket.polygon.io")=>a(`${s}/crypto`,t);var Ne=(t,s="wss://socket.polygon.io")=>a(`${s}/forex`,t);var ze=(t,s="wss://socket.polygon.io")=>a(`${s}/indices`,t);var He=(t,s="wss://socket.polygon.io")=>a(`${s}/options`,t);var je=(t,s="wss://socket.polygon.io")=>a(`${s}/stocks`,t);var Ze=(t,s)=>({crypto:()=>We(t,s),forex:()=>Ne(t,s),indices:()=>ze(t,s),options:()=>He(t,s),stocks:()=>je(t,s)}),Ve=Ze;var Ke=(t,s,o)=>({rest:Me(t,s),websockets:Ve(t,o)}),zm=Ke;export{W as cryptoClient,zm as default,se as forexClient,We as getCryptoWebsocket,Ne as getForexWebsocket,ze as getIndicesWebsocket,He as getOptionsWebsocket,je as getStocksWebsocket,i as getWithGlobals,Ue as indicesClient,Ce as optionsClient,Ke as polygonClient,fe as referenceClient,Je as restClient,Q as snapshotOptionChain,q as snapshotOptionContract,Fe as stocksClient,Ze as websocketClient};
